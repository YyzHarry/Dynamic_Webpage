<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" name="viewport" content="width=device-width,
                                                   initial-scale=1.0,
                                                   maximum-scale=1.0,
                                                   user-scalable=no">

    <title>3D AQI Maps in Peking University</title>

    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="css/bootstrap.min.css">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="js/jquery-3.1.1.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="js/bootstrap.min.js"></script>

    <!-- cookie库 -->
    <script src="js/jquery.cookie.js"></script>

    <!-- form库 -->
    <script src="js/jquery.form.js"></script>

    <!-- 消息提示库 -->
    <link rel="stylesheet" href="css/lobibox.min.css">
    <script src="js/lobibox.min.js"></script>

    <!-- 主页逻辑 -->
    <script type="text/javascript" src="js/utilis.js"></script>
    <script type="text/javascript" src="js/index.js"></script>

    <!-- 百度API接口调用 -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      body {width: 100%;  height: 100%; font-family:"微软雅黑"; text-align: center;}
      html {width: 100%;  height: 100%; font-family:"微软雅黑"; text-align: center;}
      #allmap {width:100%; height:400px;}
      #center {margin-right: auto; margin-left: auto;}
      p{margin-left:5px; font-size:14px;}
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=8eewclsuZLaIKiIMOdbWK59drLfAyr1a"></script>
    <!-- <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script> -->

  </head>

  <body>
    <header class="navbar navbar-default navbar-static-top" role="navigation">
      <div id="header" class="container">
        <!--
        <a class="navbar-text navbar-link navbar-left glyphicon glyphicon-home" href="./index.html"></a>
        <h1 id="identity"class="navbar-text label label-defualt"></h1>
        <div id="controller" class="navbar-right btn-group" role="button">
        </div>
      </div>
    </header>
        -->
        <a class="navbar-text navbar-link navbar-left" href="./index.html">
          <button class="btn btn-default btn-sm" role="button">
            <span class="glyphicon glyphicon-home"></span>
            <strong><span style="font-family: Georgia;">Home</span></strong>
          </button>
        </a>
        
        <a class="navbar-right" href="http://www.pku.edu.cn/" target="_blank"><img src="img/pku.jpg"></a>

        <div class="navbar-right navbar-text">
          <b><p style="font-family: Georgia; font-size: 16px; color: #333">3D Aqi Maps in Peking University&nbsp;&nbsp;&nbsp;</p></b>
        </div>
      </div>
    </header>

    <!-- 调用百度地图API -->
      <div class="container" role="map">
        <div id="allmap"></div>
      </div>
  
      <script type="text/javascript">
        // 百度地图API功能
        var map = new BMap.Map("allmap");

        map.enableScrollWheelZoom();   //启用滚轮放大缩小
        map.enableContinuousZoom();   //启用地图惯性拖拽

        /*
        //中心点
        var point = new BMap.Point(116.316176,39.997743);
        var marker = new BMap.Marker(point);  // 创建标注
        map.addOverlay(marker);              // 将标注添加到地图中
        */
        map.centerAndZoom(new BMap.Point(116.316176,39.997743), 16);

        /*
        var opts = {
          width : 200,     // 信息窗口宽度
          height: 100,     // 信息窗口高度
          title : "Peking University", // 信息窗口标题
          enableMessage:true,//设置允许信息窗发送短息
          message:""
        }
        var infoWindow = new BMap.InfoWindow("地址：北京市海淀区颐和园路5号", opts);  // 创建信息窗口对象 
        marker.addEventListener("click", function(){          
          map.openInfoWindow(infoWindow,point); //开启信息窗口
        });
        */

        var data_info = [[116.319421,39.99547,"二教"],
                         [116.317948,39.992485,"南门"],
                         [116.311067,40.000707,"西门"],
                         [116.317022,39.997895,"图书馆"],
                         [116.321765,39.994544,"邱德拔"],
                         [116.317094,39.995905,"百讲"],
                         [116.316748,40.000545,"未名湖"]
                        ];
        var opts = {
            width : 200,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : "AQI_Maps in Peking University" , // 信息窗口标题
            enableMessage:true//设置允许信息窗发送短息
        };
        for(var i=0;i<data_info.length;i++){
          var marker = new BMap.Marker(new BMap.Point(data_info[i][0],data_info[i][1]));  // 创建标注
          var content = data_info[i][2];
          map.addOverlay(marker);               // 将标注添加到地图中
          addClickHandler(content,marker);
        }
        function addClickHandler(content,marker){
          marker.addEventListener("click",function(e){
            openInfo(content,e)}
          );
        }
        function openInfo(content,e){
          var p = e.target;
          var point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
          var infoWindow = new BMap.InfoWindow(content,opts);  // 创建信息窗口对象 
          map.openInfoWindow(infoWindow,point); //开启信息窗口
        }

      </script>

    <br>

    <div class="container" role="search">
      <form id="query_form" class="form-inline row well well-sm" role="form">
        <div class="form-group col-md-offset-1 col-md-2 col-sm-offset-1 col-sm-3">
          <p class="form-control-static">地点</p>
          <select id="district_select" class="form-control" name="district">
          </select>
        </div>
        <div class="form-group col-md-offset-2 col-md-2 col-sm-offset-1 col-sm-3">
          <p class="form-control-static">查询方式</p>
          <select id="type_select" class="form-control" name="type">
            <option value="now">实时</option>
            <option value="average">日平均</option>
          </select>
        </div>
        <div class="form-group col-md-offset-4 col-md-1 col-sm-offset-1 col-sm-1">
          <button id="query_btn" type="button" class="btn btn-info">查询</button>
        </div>
      </form>
    </div>
    <div class="container">
      <div id="display" class="row">
        <!-- 显示AQI参数值 -->
      </div>
    </div>
  </body>
</html>
